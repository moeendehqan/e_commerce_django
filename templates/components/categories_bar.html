{% load static %}
<section class="relative w-full my-[50px] px-4" aria-label="دسته‌بندی‌های فروشگاه">
    <h2 class="text-2xl font-bold text-center text-gray-800 mb-8">دسته‌بندی‌ها</h2>

    <div class="relative flex justify-center items-center">
        <!-- دکمه چپ -->
        <button 
            id="cat-prev"
            aria-label="قبلی"
            class="hidden md:flex absolute left-0 z-10 bg-white/70 backdrop-blur-md p-3 rounded-full shadow hover:bg-white transition"
        >
            <i class="fas fa-chevron-right text-gray-700"></i>
        </button>

        <!-- لیست دسته‌بندی‌ها -->
        <div 
            id="category-slider" 
            class="flex gap-6 overflow-x-auto scroll-smooth px-8 scrollbar-hide justify-center"
        >
            {% for category in categories %}
                {% if category.is_active %}
                    <a 
                        href="{{ category.get_absolute_url }}" 
                        title="{{ category.meta_title|default:category.name }}" 
                        aria-label="مشاهده دسته‌بندی {{ category.name }}"
                        class="flex flex-col items-center flex-shrink-0 group w-24 md:w-28 text-center"
                    >
                        <div class="relative w-24 h-24 md:w-28 md:h-28 rounded-full p-[3px] bg-gradient-to-tr from-pink-500 via-yellow-400 to-purple-500 transition-all duration-500 group-hover:scale-110">
                            <div class="w-full h-full rounded-full bg-white p-[2px]">
                                {% if category.image %}
                                    <img 
                                        src="{{ category.image.url }}" 
                                        alt="{{ category.name }}" 
                                        loading="lazy"
                                        class="w-full h-full rounded-full object-cover"
                                    >
                                {% else %}
                                    <div class="w-full h-full rounded-full bg-gray-200 flex items-center justify-center text-gray-500 text-sm">
                                        بدون تصویر
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                        <span class="mt-2 text-sm md:text-base text-gray-700 font-medium truncate w-full group-hover:text-pink-600">
                            {{ category.name }}
                        </span>
                    </a>
                {% endif %}
            {% empty %}
                <p class="text-gray-600 text-center w-full py-6">هیچ دسته‌بندی فعالی یافت نشد.</p>
            {% endfor %}
        </div>

        <!-- دکمه راست -->
        <button 
            id="cat-next"
            aria-label="بعدی"
            class="hidden md:flex absolute right-0 z-10 bg-white/70 backdrop-blur-md p-3 rounded-full shadow hover:bg-white transition"
        >
            <i class="fas fa-chevron-left text-gray-700"></i>
        </button>
    </div>
</section>

<style>
.scrollbar-hide::-webkit-scrollbar { display: none; }
.scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }

/* gradient border animation */
@keyframes gradient-rotate {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

.bg-gradient-to-tr {
  background-size: 200% 200%;
  animation: gradient-rotate 5s ease infinite;
}
</style>

<script>
document.addEventListener("DOMContentLoaded", () => {
    const slider = document.getElementById("category-slider");
    const next = document.getElementById("cat-next");
    const prev = document.getElementById("cat-prev");

    // فعال کردن دکمه‌ها فقط در دسکتاپ
    if (window.innerWidth >= 768) {
        next.classList.remove("hidden");
        prev.classList.remove("hidden");
    }

    next.addEventListener("click", () => {
        slider.scrollBy({ left: 250, behavior: "smooth" });
    });

    prev.addEventListener("click", () => {
        slider.scrollBy({ left: -250, behavior: "smooth" });
    });
});
</script>
